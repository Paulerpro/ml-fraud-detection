# ğŸ“Œ **README.md â€” Credit Card Fraud Detection (PyTorch + Streamlit + FastAPI)**

## ğŸ§  Overview

This project is an **End-to-End Credit Card Fraud Detection System** built using:

* **PyTorch** â€” for model training
* **Scikit-Learn** â€” for preprocessing & evaluation
* **Streamlit** â€” for the interactive UI
* **FastAPI** â€” for production-grade API deployment
* **MLflow (planned)** â€” for experiment tracking
* **Google Colab** â€” for GPU-accelerated training

The model is trained on the **Kaggle Credit Card Fraud Dataset**, a highly imbalanced dataset of >284,000 transactions.

This repository contains a clean, modular, production-ready Python project structure separating:

âœ” Training
âœ” Inference
âœ” API layer
âœ” UI layer
âœ” Notebooks
âœ” Model artifacts (`best_model.pt`, `scaler.pkl`)

---

# ğŸ“‚ **Project Structure**

```
ml-fraud-detection/
â”‚
â”‚
â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ main.py          # FastAPI entry file
â”‚   â”œâ”€â”€ schemas.py       # Data schema
â”‚   â”œâ”€â”€ service.py       # FastAPI business logic
â”‚   â””â”€â”€ __init__.py 
â”‚
â”‚
â”œâ”€â”€ ml_fraud_detection/
â”‚   â”œâ”€â”€ training/
â”‚   â”‚   â”œâ”€â”€ train.py          # Training pipeline (from preprocessing â†’ saving model)
â”‚   â”‚   â”œâ”€â”€ model.py          # MLP model architecture
â”‚   â”‚   â”œâ”€â”€ dataset.py        # Custom PyTorch Dataset and DataLoaders
â”‚   â”‚   â””â”€â”€ utils.py          # Helper utilities (metrics, seeding, loaders)
â”‚   â”‚
â”‚   â”œâ”€â”€ inference/
â”‚   â”‚   â””â”€â”€ predict.py        # Loads model + scaler â†’ predicts fraud
â”‚   â”‚
â”‚   â””â”€â”€ __init__.py
â”‚
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ best_model.pt              # Exported PyTorch model weights
â”‚   â”œâ”€â”€ scaler.pkl            # StandardScaler used during preprocessing
â”‚
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ streamlit_app.py      # UI for interactive predictions
â”‚
â”œâ”€â”€ notebooks/
â”‚   â””â”€â”€ training_notebook.ipynb   # Colab training/EDA notebook
â”‚
â”œâ”€â”€ requirements.txt          # Auto-generated by uv / pip
â””â”€â”€ README.md                 # You are here
```

---

# ğŸ—‚ï¸ Dataset â€” Credit Card Fraud (Kaggle)

* **284,807 transactions**
* **492 fraud cases (0.17%)**
* Contains PCA-transformed features: `V1` â†’ `V28`
* Additional features: `Time`, `Amount`
* Target label: `Class`

  * `0` = legitimate
  * `1` = fraud

---

# ğŸ§ª **Model Architecture (MLP)**

A simple but effective neural network:

* Input Layer â†’ 128 â†’ 64 â†’ Output
* BatchNorm
* ReLU activation
* Dropout for regularization
* Uses `BCEWithLogitsLoss` + **class weights** to handle imbalance
* Adam optimizer

---

# ğŸ” Training Pipeline

The training pipeline in `train.py` handles:

### âœ” Reproducibility (seed_everything)

### âœ” Preprocessing

* Standardizes `Time` and `Amount`
* Keeps PCA components as-is

### âœ” Stratified Splits

* Train
* Validation
* Test

### âœ” Weighted BCE Loss

To counter the massive class imbalance.

### âœ” Early Stopping (AUC-based)

### âœ” Saving Artifacts

```
models/
â”‚â”€â”€ best_model.pt
â”‚â”€â”€ scaler.pkl
```

---

# ğŸ’¡ Training â€” Run Locally

Activate your venv and install dependencies:

```bash
uv init  # creates pyproject.toml
uv add torch scikit-learn pandas numpy matplotlib seaborn fastapi uvicorn streamlit
```

Run training:

```bash
python ml_fraud_detection/training/train.py
```

---

# ğŸ¯ **Inference (Prediction Pipeline)**

`predict.py` loads:

* `best_model.pt`
* `scaler.pkl`

And exposes a function:

```python
predict_fraud(transaction_dict)
```

Returns:

* Probability of fraud
* Binary decision

Run manually:

```bash
python ml_fraud_detection/inference/predict.py
```

---

# ğŸ–¥ï¸ **Streamlit Application**

Interactive fraud prediction UI.

Run:

```bash
streamlit run app/streamlit_app.py
```

The UI allows users to:

* Manually input transaction data
* Get prediction probability
* Model explanation (coming soon via SHAP)

---

# âš¡ **FastAPI Integration**

The backend API (`api/main.py`) will expose:

### **POST /predict**

Request:

```json
{
  "Time": 120.0,
  "Amount": 59.99,
  "V1": -1.23,
  "V2": 0.12,
  ...
  "V28": 0.87
}
```

Response:

```json
{
  "fraud_probability": 0.824,
  "is_fraud": true
}
```

### **Run FastAPI**

```bash
uvicorn api.main:app --reload
```

This allows:

* Integrating your model with mobile apps
* Deploying behind Nginx
* Building a microservice architecture
* Streamlit frontend calling FastAPI backend

---

# ğŸš€ Deployment (Planned)

Upcoming deployment options:

* **Docker container**
* **Railway / Render / Azure / AWS EC2**
* **MLflow model registry**
* **FastAPI reverse proxy**

---

# ğŸ“Š Model Performance

| Metric                 | Score      |
| ---------------------- | ---------- |
| Test AUC               | **0.9660** |
| Test Average Precision | **0.722**  |

Very strong considering the extreme imbalance.

---

# ğŸ““ **Notebook**

`training_notebook.ipynb` includes:

* EDA
* Data visualizations
* Model experimentation
* Performance plots
* Quick prototyping

Production code lives in `ml_fraud_detection/`.

---

# ğŸ§° **Environment Setup (uv)**

Check installed dependencies:

```bash
uv pip list
```

Install new dependencies:

```bash
uv add fastapi uvicorn
```

Sync environment:

```bash
uv sync
```

---

# ğŸ‘¤ **Author**

**Paulerpro**

* AI / ML Engineer
* Focused on practical end-to-end AI systems
* Passion for med-tech, ML engineering, and automation

---

# ğŸ’¬ Support

Issues? Open one in GitHub or message me.